//DragonCrypto - DLL File to be used with DragonClient for encrypting and decrypting packets on DragonNest (works on all world regions)
//Alex M. Schwarz, 2015
//DragonNest uses static XTEA crypto for Village/TCPServer transactions, key changes each patch.
//m_TeaKey would look way better as a 2D Array as it's intended, but I wrote this code back in the noob days.

#include <Windows.h>
#define TEA_DELTA = 0x9E3779B9
#define TEA_BLOCKSIZE = 8
#define TEA_KEYCOUNT = 256

//4kb key + ptr at front = 4100 byte
unsigned char m_TeaKey[] = {0x7C,0x1E,0xEF,0x00,0xCB,0x49,0xD2,0x40,0x9D,0x2F,0xE5,0x13,0xD3,0xDD,0x16,0x04,0xB6,0x7D,0xF1,0x0A,0x3E,0x59,0x0B,0x1E,0x27,0x77,0xB6,0x2F,0x85,0x71,0x21,0x30,0xA0,0x9D,0xDF,0x75,0x70,0xD7,0x47,0x08,0xB2,0x7D,0x2A,0x6E,0xD2,0xF7,0xFB,0x00,0x1D,0x89,0x6B,0x47,0x9B,0xEA,0x9A,0x23,0x3F,0x6E,0xFE,0x2F,0x68,0xFE,0x11,0x45,0x62,0x33,0x2A,0x4F,0x77,0x8A,0x2D,0x5E,0xF4,0x04,0x49,0x39,0x92,0xDB,0x15,0x3E,0x50,0xFC,0xE4,0x4D,0xAC,0xCF,0x4A,0x13,0x48,0x47,0x5F,0x3F,0xCB,0x77,0x0D,0x12,0x9C,0xFC,0x68,0x6C,0x95,0xAC,0xB8,0x3D,0xFA,0xA8,0x7A,0x64,0x2A,0x15,0x1D,0x3F,0x8B,0x75,0x31,0x7F,0x6E,0xF5,0xC7,0x11,0x6A,0x4B,0x09,0x0F,0x13,0xB3,0x3F,0x4D,0xE4,0x95,0x32,0x47,0x09,0xA9,0x9A,0x10,0xFE,0x8E,0xE3,0x42,0xFE,0xFE,0xE4,0x34,0x54,0x7D,0xA5,0x30,0x96,0x48,0x0F,0x47,0x45,0xF3,0x99,0x44,0x20,0x81,0xCB,0x52,0x4A,0x5D,0x20,0x1B,0x60,0x24,0xA2,0x23,0x89,0x41,0xEB,0x5B,0xDA,0xC1,0xD9,0x70,0x26,0x58,0x84,0x3C,0x8B,0x46,0x52,0x71,0x1F,0xD6,0xF2,0x52,0x40,0xCA,0x8D,0x7D,0xE1,0x97,0xA7,0x01,0x36,0x9D,0xB4,0x24,0x30,0xA7,0x45,0x76,0xD1,0x17,0x59,0x37,0x64,0x25,0xB2,0x65,0x38,0x55,0x1C,0x73,0x9B,0x6F,0xEF,0x78,0x91,0xA7,0xC1,0x70,0x83,0x8F,0x1A,0x27,0xED,0x29,0x2B,0x5C,0xA4,0x7E,0x6F,0x12,0xED,0x18,0x92,0x7E,0xAE,0xF3,0xEF,0x6F,0xEB,0xF0,0x38,0x38,0x16,0xA7,0x9D,0x09,0x38,0x22,0x1A,0x6C,0x2A,0xB9,0x79,0x64,0xE7,0x10,0x29,0x04,0xE0,0xE9,0x47,0x09,0xF8,0xA8,0x0C,0x1F,0xC1,0xDE,0xC7,0x1C,0xE7,0x32,0x9E,0x4B,0xBC,0x52,0x3A,0x40,0x33,0x46,0x29,0x7F,0xAB,0x96,0xCD,0x19,0xA0,0xFD,0x8F,0x0D,0x29,0x53,0xCA,0x24,0x48,0x8D,0xF6,0x0D,0xD3,0x9A,0x99,0x3E,0x1F,0x14,0x9E,0x0E,0x06,0x61,0x3E,0x6A,0x55,0xA3,0xA9,0x53,0xD5,0x47,0x5F,0x2C,0xB0,0xD5,0x7E,0x22,0xCA,0xBE,0x8C,0x31,0x78,0x36,0x82,0x49,0xD7,0x3B,0x3C,0x65,0xD1,0xD1,0x54,0x2E,0x6F,0xA6,0x2C,0x49,0x4C,0x1A,0x55,0x0D,0x30,0xB9,0x4C,0x50,0x48,0x68,0xF1,0x7F,0x36,0xC0,0x6D,0x19,0x61,0x66,0x93,0x66,0xF6,0xBC,0x92,0x3C,0x5B,0xA8,0x6D,0x41,0x4C,0x8F,0x76,0x64,0x5F,0xE2,0xBA,0x10,0xAA,0x89,0x82,0x58,0x45,0xD7,0xCF,0x5B,0xD0,0x5E,0xDB,0x39,0xEB,0x76,0x26,0x30,0x26,0xCC,0x78,0x44,0x7F,0x33,0x77,0x47,0x07,0x5F,0xB4,0x6C,0x13,0xF4,0x8B,0x6B,0xC6,0x31,0xFC,0x60,0x87,0x8B,0x41,0x67,0x89,0x98,0x1C,0x21,0x08,0x5E,0xBC,0x44,0xBF,0xBD,0xDF,0x6F,0x42,0x3D,0x8E,0x67,0xA4,0x7F,0x2E,0x6E,0x11,0x8A,0x03,0x78,0x6A,0x9B,0xAD,0x0F,0xE9,0x58,0x37,0x67,0xDF,0x7A,0x4F,0x4D,0xA4,0x79,0x74,0x60,0x0F,0xDD,0x4A,0x54,0xB1,0xF7,0xD5,0x61,0x97,0x07,0xB9,0x4F,0x1F,0x5D,0x18,0x49,0xAB,0x8D,0x2C,0x0F,0x66,0xAE,0xC5,0x27,0x66,0x57,0x47,0x22,0xBA,0x96,0xE2,0x50,0x4C,0x1C,0xEE,0x14,0xF3,0x95,0x54,0x71,0xF3,0x87,0x88,0x23,0x19,0xAE,0x69,0x06,0x60,0xF9,0x01,0x08,0xD2,0xA9,0x96,0x06,0x9A,0xC6,0x71,0x1C,0xD1,0xB2,0x64,0x1A,0x30,0x12,0x3C,0x7D,0x3C,0x2F,0xE9,0x68,0x14,0x74,0x2F,0x65,0xE6,0x98,0xDB,0x19,0x95,0x94,0xA5,0x39,0x0E,0x03,0x9B,0x03,0xBC,0x9B,0xBF,0x3C,0xE5,0x32,0xA5,0x13,0xA5,0x8A,0xFB,0x43,0xD9,0x66,0xD9,0x2C,0xA9,0xE4,0xA9,0x01,0x45,0x09,0xD1,0x17,0xD1,0x1E,0x62,0x4D,0x0D,0x4F,0x3A,0x19,0x97,0x8B,0x3F,0x77,0x2B,0x4F,0xCF,0x27,0xAF,0x48,0xEE,0x29,0x74,0xBE,0xBF,0x17,0xD6,0x97,0xAA,0x15,0xED,0x12,0x5E,0x4B,0xBA,0xD6,0x23,0x7A,0x6F,0xC6,0xCD,0x43,0x8C,0x63,0x91,0x26,0xB8,0x4C,0x5B,0x6E,0xB9,0xED,0x78,0x27,0x38,0x1D,0xA5,0x17,0xF5,0x68,0xF2,0x7A,0x61,0xFE,0xB2,0x4C,0x8C,0x25,0x92,0x33,0xC0,0x95,0x4A,0x68,0xE4,0x9F,0x0D,0x63,0x32,0x9F,0x8D,0x66,0x76,0xC1,0x75,0x67,0xF0,0xCA,0x58,0x44,0xC4,0x61,0x0D,0x46,0xBB,0x22,0xBD,0x5C,0xB2,0x57,0x24,0x4E,0xDE,0x2B,0xBD,0x1D,0xBB,0xB9,0x12,0x59,0x0A,0x4E,0x6D,0x2F,0x53,0x61,0x8C,0x4F,0x68,0x56,0x65,0x4B,0xD0,0x20,0x00,0x4D,0xA9,0xD9,0x40,0x5B,0x9B,0x7A,0x3E,0x31,0x39,0x72,0x37,0x4B,0x4E,0xCA,0x70,0x5A,0x12,0xAD,0x4A,0x03,0xF5,0xA9,0xE1,0x10,0x75,0x2A,0xF1,0x0D,0x80,0x2B,0x7C,0x52,0x9C,0x4C,0xAA,0x1F,0xAD,0xC0,0x2E,0x79,0xD9,0x03,0xF0,0x50,0x50,0x36,0x0B,0x2C,0xE5,0xFD,0x96,0x68,0x5E,0x8A,0x74,0x25,0xBE,0xCF,0x85,0x0E,0x68,0x4C,0x28,0x72,0xB8,0xD9,0x09,0x1C,0xCE,0x14,0xA0,0x18,0x28,0x46,0x4D,0x6B,0x96,0x5F,0x9B,0x35,0x27,0x0D,0x32,0x1E,0x81,0xF3,0x6A,0x39,0x79,0x11,0xD0,0x1C,0xA3,0x2D,0xAC,0x36,0xA4,0x97,0xF4,0x4E,0x87,0x31,0x01,0x7D,0xFC,0x7B,0x91,0x74,0xF9,0xF6,0xE1,0x22,0x88,0x41,0x23,0x7D,0x66,0x61,0x0F,0x37,0x9A,0xF0,0x51,0x34,0x07,0x69,0xD3,0x40,0xE4,0x40,0x69,0x1B,0x67,0xC2,0xBF,0x28,0x3E,0xF4,0xA7,0x27,0xCA,0x4B,0x33,0x34,0x49,0xA0,0xD5,0x69,0x74,0xCE,0x44,0x6B,0xEA,0xCF,0x7F,0x46,0xA3,0xD4,0x6A,0x4E,0xD6,0x02,0xE8,0x5F,0x31,0x02,0xF2,0x03,0xBD,0x98,0x41,0x04,0x70,0x8F,0x39,0x1A,0xBC,0xF1,0x05,0x10,0xD7,0x08,0x3D,0x5A,0x0F,0x8B,0xBF,0x25,0xE6,0x18,0x30,0x32,0x89,0x4D,0x6F,0x06,0x21,0x39,0xE0,0x19,0x38,0x4F,0x03,0x35,0x1A,0x51,0x26,0x7A,0x6A,0xA5,0x82,0x7A,0x8A,0xCA,0x36,0x67,0x4F,0x3C,0xA0,0x6C,0x24,0xDD,0xF2,0x4C,0x97,0x9B,0x31,0x5B,0x77,0x53,0xDA,0x2D,0x52,0x59,0x68,0x1D,0xCC,0x38,0x69,0x79,0xA9,0xAA,0x17,0x54,0x8D,0x19,0x57,0x14,0xB7,0xF8,0xBC,0x5F,0x34,0xA2,0x70,0x68,0x85,0x77,0x63,0x7B,0x5F,0x03,0x99,0x3F,0x0D,0x88,0xCC,0x7C,0x37,0xD9,0x97,0x00,0xF0,0x35,0xCC,0x39,0x17,0x65,0x2E,0x69,0x9B,0xA1,0x8A,0x27,0x26,0xC0,0x39,0x1E,0x4B,0x33,0xD8,0x24,0x90,0xDB,0x47,0x05,0x1A,0x62,0x3F,0x60,0x05,0xDE,0xAC,0x30,0xBA,0x4E,0xD0,0x3D,0x91,0x74,0x40,0x32,0xA6,0x6D,0xAF,0x0A,0xB5,0x79,0xDA,0x08,0xBA,0xEB,0xC4,0x03,0x40,0x02,0x7E,0x2C,0xEC,0xB3,0xBE,0x7B,0x65,0x27,0xA6,0x41,0x2C,0x50,0x73,0x66,0xBC,0x85,0xEB,0x55,0xAB,0xC1,0x0F,0x76,0x4D,0x4D,0xFA,0x0E,0xBA,0x8B,0x2D,0x60,0x61,0x46,0x35,0x7E,0xA1,0x4A,0x32,0x41,0x2D,0x64,0xAF,0x0E,0xA0,0xEF,0x0B,0x23,0x92,0x3D,0xFA,0x0D,0xDF,0xE3,0x3C,0x38,0xEE,0x4D,0x41,0x79,0x8D,0x4B,0x91,0x29,0x77,0x3D,0xDD,0x5E,0xD7,0x46,0x23,0x5D,0xC4,0xCF,0xAA,0x2E,0x13,0x3E,0x88,0x7A,0x3E,0x40,0x77,0x60,0xDB,0x5F,0x8C,0x0E,0x1D,0x81,0xCB,0x23,0x85,0x9A,0x98,0x07,0xA0,0xAA,0x8A,0x02,0x57,0xA2,0x6F,0x5B,0x91,0xA6,0x76,0x11,0xE2,0x14,0xCE,0x28,0x2B,0x6B,0xE3,0x75,0x81,0xB9,0x5F,0x17,0x25,0x75,0x82,0x74,0x71,0x7C,0xA5,0x07,0x3F,0x36,0xC0,0x74,0x20,0x9B,0x08,0x51,0xD6,0x9B,0xD5,0x69,0xC2,0x08,0x59,0x2F,0x13,0xD9,0x2D,0x61,0xE0,0xB6,0x5D,0x3A,0x22,0x3A,0xF0,0x72,0x42,0xEE,0xC7,0x65,0x44,0xF0,0x6D,0x4B,0x93,0x6E,0x5F,0x1F,0xE7,0xE6,0x0B,0x7B,0x45,0xE3,0x33,0x2A,0xB9,0x75,0xFE,0x54,0x1A,0x10,0xCD,0x17,0xB1,0xB2,0xC4,0x4A,0x7C,0xB6,0x6E,0x6A,0x8B,0x96,0x2D,0x60,0xF1,0x56,0xF5,0x57,0xE0,0x03,0x3F,0x22,0xFA,0x8F,0x87,0x51,0xF9,0x8E,0x77,0x69,0x59,0x3E,0x88,0x51,0xED,0x84,0x71,0x0A,0xE4,0x62,0x6E,0x31,0x80,0x93,0xEE,0x66,0x0B,0x6F,0x7E,0x23,0x92,0xCD,0xF9,0x04,0xBF,0x9E,0xA8,0x2D,0xAA,0x9F,0x08,0x47,0x2F,0x84,0xFA,0x11,0x31,0x4C,0x14,0x17,0x39,0x0D,0x02,0x35,0xD1,0xC8,0xE2,0x07,0x63,0xAE,0x3A,0x13,0x2F,0x21,0x0B,0x15,0x8E,0x50,0x14,0x52,0x9C,0x24,0xBC,0x32,0x92,0xBF,0xD8,0x1F,0x33,0x13,0x2D,0x59,0x1F,0x33,0xC6,0x1E,0x20,0x3E,0x63,0x4A,0xAE,0xD4,0xD2,0x5A,0x3A,0x25,0x10,0x1C,0xAD,0xFB,0xD7,0x01,0x63,0x4E,0x4A,0x6D,0xCA,0xEF,0x51,0x45,0xD6,0xEF,0xF5,0x7F,0x26,0x35,0x14,0x14,0xBF,0x5C,0x84,0x3A,0x94,0x42,0x23,0x64,0x98,0xBC,0xFB,0x25,0xC3,0x44,0x32,0x16,0x7F,0xA4,0x91,0x0C,0x72,0xBF,0xB3,0x10,0x53,0x0A,0xD9,0x3C,0x66,0x05,0x28,0x15,0x5E,0x62,0xC1,0x57,0x1F,0x34,0x26,0x42,0xAE,0x90,0x5E,0x18,0x2E,0x0C,0xB1,0x43,0x1B,0xF8,0x70,0x48,0x76,0xBF,0xF4,0x67,0x81,0x54,0xAD,0x27,0x63,0xA1,0x5E,0x56,0xC5,0x9F,0xF2,0x1B,0x51,0x62,0xF3,0x46,0xF5,0xEB,0xDC,0x28,0xE6,0xE2,0x1B,0x2E,0x5A,0x74,0xDF,0x2E,0xA8,0x04,0xE2,0x27,0xE3,0x3B,0x02,0x70,0x6F,0xAE,0xE9,0x57,0xB8,0x81,0x31,0x6F,0xE4,0x95,0x91,0x43,0x55,0x8D,0xED,0x60,0x03,0x4E,0x60,0x2A,0x52,0x51,0x24,0x5F,0x92,0xE2,0xC3,0x7C,0xF9,0xCE,0x9B,0x50,0x83,0x07,0x76,0x37,0x02,0x4D,0xA2,0x1E,0x4A,0xF1,0x4C,0x3D,0xF7,0x5B,0x0A,0x0C,0x10,0xD3,0x9B,0x0B,0x5E,0xBC,0x31,0x0C,0x9A,0x4D,0x3C,0x03,0x00,0x1E,0xC7,0x57,0xD6,0x2F,0x93,0x43,0x54,0x12,0x90,0x28,0xD9,0xCA,0xBB,0x72,0x20,0x4E,0xCA,0x6F,0x74,0x89,0x3D,0x07,0x9F,0x90,0xFF,0x1F,0x0A,0xF0,0xF0,0x45,0x18,0xB5,0x03,0x7F,0x0B,0x4C,0x28,0x69,0xEF,0x58,0x23,0x38,0xC5,0x24,0xDC,0x16,0x81,0xB4,0x4E,0x6A,0xC5,0x83,0x4D,0x2E,0x5D,0x42,0x42,0x01,0x7C,0x55,0x6F,0x41,0x0A,0x4A,0x01,0x2D,0x2E,0x65,0x0E,0x72,0xC6,0x06,0x2F,0x32,0x13,0xF2,0x99,0x33,0x45,0x2C,0x0A,0x74,0x56,0xD4,0xDF,0x0B,0xAD,0xBD,0xC6,0x54,0x94,0x66,0x91,0x6F,0xAB,0xCE,0x5D,0x65,0xD4,0xF9,0xEE,0x09,0xFC,0x05,0xE4,0x7C,0x57,0x0E,0xE7,0x32,0xAA,0x65,0x06,0x11,0x79,0x32,0x77,0x50,0x67,0xC3,0x15,0x62,0x02,0xDF,0x65,0x0B,0x40,0x96,0xD6,0x6E,0x1C,0xB3,0x06,0x47,0x05,0x7E,0x69,0x7C,0x8A,0x9E,0x74,0x7F,0x2A,0x81,0xCD,0x03,0x2A,0xC6,0xBA,0x63,0x4A,0x94,0x39,0x6B,0x6F,0x1A,0x33,0x4C,0x8E,0x90,0x86,0x12,0x2D,0xE9,0xE5,0x2B,0xC4,0x4F,0xCC,0x74,0x52,0x89,0xB0,0x61,0x69,0xDD,0x4D,0x13,0x58,0x69,0xA0,0x29,0xB9,0x5E,0xE2,0x60,0xE9,0x49,0xE8,0x7F,0x27,0x9E,0x1B,0x01,0x57,0x1A,0x4B,0x24,0xB4,0xC8,0xDB,0x66,0xD8,0xB8,0xEC,0x0F,0xFF,0xDF,0xC4,0x40,0x2B,0x41,0x5E,0x6D,0x75,0x88,0xC1,0x0D,0x0F,0x05,0xC4,0x53,0x98,0xBB,0xE8,0x17,0x6B,0xB1,0x3A,0x1F,0x7D,0x24,0x83,0x71,0x77,0xD4,0xC4,0x4A,0xFE,0xCE,0x98,0x4E,0x32,0x87,0xB6,0x05,0xCE,0xE2,0x17,0x77,0xF2,0x25,0xEE,0x61,0xFB,0x40,0xF5,0x66,0x75,0x9A,0x2A,0x23,0xB7,0x59,0x89,0x60,0xD7,0xFD,0xB7,0x30,0x8E,0x46,0x65,0x6C,0x4F,0x0F,0x8A,0x11,0x43,0x94,0xD1,0x44,0xCA,0xCE,0x67,0x73,0x78,0x01,0x1D,0x4D,0xF3,0x02,0x60,0x15,0xF0,0xDE,0x35,0x35,0x9B,0x32,0x3E,0x2E,0xE2,0x5F,0x28,0x3A,0x8B,0x36,0xD8,0x74,0x28,0x30,0x48,0x1B,0xA2,0xF5,0x66,0x5C,0xAC,0x68,0x5C,0x56,0x1F,0x30,0x5C,0x54,0xD0,0x2C,0xF7,0x75,0xF0,0x18,0xA8,0x7B,0xA4,0x0D,0xDC,0x16,0x87,0x46,0xC8,0x54,0xAE,0x96,0x1A,0x49,0xFE,0x56,0xF7,0x0C,0x4B,0xD7,0xAE,0x5D,0x6B,0xCD,0x00,0x2B,0x31,0xEC,0x46,0x7A,0xA7,0x0F,0x7F,0x17,0xDA,0x4D,0x2D,0x07,0x54,0xBD,0xD5,0x11,0x12,0x28,0x5F,0x63,0x23,0xDA,0xA5,0x34,0xA9,0x57,0x56,0x6E,0x10,0xCE,0xF6,0x43,0x7E,0xC0,0x21,0x5B,0xAC,0xAA,0x25,0x1C,0x64,0x74,0xC8,0x5A,0xE9,0xBA,0xA2,0x6D,0x46,0xD3,0x81,0x71,0x2F,0x27,0x34,0x77,0x24,0x6B,0xFE,0x72,0x3A,0x2A,0x6C,0x28,0x1B,0xD6,0x1F,0x02,0x73,0xAE,0xFB,0x2B,0x12,0x6F,0xE0,0x0C,0xF9,0x36,0xAE,0x50,0xE5,0x26,0x25,0x2A,0xA5,0x0D,0x07,0x63,0xE8,0x41,0xFD,0x49,0x58,0x4E,0x0A,0x16,0xE3,0x51,0x5D,0x10,0xA5,0xD6,0x81,0x17,0xD1,0xC9,0x04,0x30,0x47,0x9A,0x15,0x79,0x6E,0xC6,0xE7,0x42,0x72,0xB2,0x23,0x25,0x25,0xE5,0xD5,0x37,0x7F,0x15,0x12,0x2C,0xCA,0x02,0x58,0x4D,0xD3,0x68,0x92,0x12,0xD9,0x6B,0x2C,0x0C,0x39,0x1C,0x53,0x21,0x36,0xCE,0x11,0x34,0x82,0xD4,0x25,0x48,0xDE,0xFB,0x89,0x15,0x2D,0x8B,0xD6,0x62,0x1B,0x54,0x75,0x3B,0xA2,0x40,0xA3,0x30,0xD9,0x31,0x0E,0x37,0xC9,0x1E,0x00,0x05,0x1F,0x75,0x38,0x24,0xA8,0x14,0xA7,0x56,0xBE,0x34,0xF9,0x27,0x71,0x4B,0x6F,0x6A,0xDF,0x76,0xDF,0x5C,0x43,0xB2,0x8C,0x31,0x22,0x07,0x4D,0x40,0xF6,0xD5,0xE4,0x4A,0x2A,0xC7,0x14,0x4F,0x0A,0x03,0xBB,0x2D,0x72,0x2B,0x3D,0x57,0x23,0x79,0x16,0x39,0x85,0x99,0x26,0x39,0x8D,0xEE,0xB1,0x0D,0xB4,0x09,0xE0,0x77,0x7C,0x99,0x4F,0x2A,0xD0,0x88,0xEF,0x54,0x83,0x06,0xC3,0x2A,0xBF,0x0B,0xE1,0x58,0x84,0x57,0x30,0x45,0x63,0x76,0x7F,0x72,0xAE,0x6F,0x45,0x4A,0x5C,0xC3,0x6F,0x40,0x08,0xDB,0x86,0x40,0x4E,0x6E,0x49,0x27,0xE5,0xFA,0x4B,0x44,0x57,0xA2,0xAA,0x2E,0x7D,0x2E,0x93,0x4A,0xC3,0x0C,0x68,0x6F,0xB6,0x87,0x62,0x41,0x8A,0xDB,0x54,0x79,0x94,0x0B,0xBE,0x6F,0xB0,0x24,0xDF,0x21,0x7C,0xAD,0x27,0x78,0x78,0xDB,0xFE,0x7C,0x4F,0x6A,0x93,0x21,0x98,0xA1,0x86,0x71,0x99,0x8A,0x0C,0x41,0x25,0x6B,0xC9,0x3A,0x6F,0xCE,0x7E,0x16,0x29,0x6F,0xBD,0x45,0x75,0xB3,0x04,0x24,0xD7,0x29,0x8E,0x4B,0xB0,0x1A,0x68,0x25,0x29,0xF1,0xAB,0x16,0x70,0x9C,0xD8,0x1E,0x2D,0x36,0xDB,0x27,0xD2,0x59,0xF5,0x74,0x86,0xC0,0x2E,0x0D,0x48,0x3A,0x9F,0x7D,0xBC,0x13,0x2C,0x02,0x63,0xF1,0x8B,0x4D,0xDC,0x0E,0x2B,0x3D,0x5F,0x98,0xA3,0x4E,0x4D,0x35,0xA9,0x79,0x9C,0x1F,0x52,0x5F,0xC4,0x19,0x1B,0x66,0x46,0xB6,0x70,0x15,0x2F,0x79,0xDD,0x43,0x90,0xC0,0x85,0x58,0xF9,0xB2,0x4F,0x17,0xD9,0xB1,0xC4,0x6D,0x6F,0x38,0xEA,0x02,0xD0,0x41,0xD0,0x77,0x9D,0xD8,0x94,0x4F,0x3B,0x27,0x1D,0x0A,0x6E,0x5C,0xB4,0x52,0x3C,0x78,0x22,0x30,0x87,0x10,0x18,0x2D,0x00,0x4D,0x89,0x21,0x00,0x8E,0xAC,0x25,0x79,0x4F,0x0C,0x75,0xAF,0x85,0xAB,0x3E,0x2C,0x60,0xCC,0x0E,0x31,0xFE,0x0F,0x0E,0x0A,0x86,0x1A,0x78,0xE3,0x6B,0x83,0x0A,0xDC,0x00,0x0B,0x07,0x58,0x9F,0xF4,0x69,0xDB,0x7A,0x36,0x38,0x6D,0x8A,0x62,0x28,0x0E,0x56,0xB0,0x05,0x41,0xE4,0x93,0x1A,0x47,0x07,0xF3,0x68,0xE8,0x70,0xC9,0x1C,0x68,0xAA,0x2D,0x46,0x47,0xF8,0xFA,0x65,0xCF,0x9F,0xDB,0x48,0xBB,0xD9,0x35,0x22,0xE8,0x0F,0xE8,0x2E,0x6D,0xF7,0x91,0x16,0xCD,0x43,0x32,0x20,0xD5,0x04,0xE8,0x4C,0xD2,0x84,0x13,0x6E,0x57,0x5E,0xE3,0x36,0x1E,0xC0,0x48,0x31,0xE8,0x73,0xE3,0x5C,0xF6,0x14,0x6D,0x7D,0xF9,0xD5,0xB2,0x50,0xCF,0x1A,0x48,0x29,0xB1,0x99,0xFF,0x6C,0xCB,0x81,0xF0,0x2A,0x6B,0xF8,0x7F,0x7E,0x30,0x6C,0xA2,0x08,0x6A,0xE2,0x65,0x3B,0x1C,0x46,0xAC,0x44,0x29,0x19,0x53,0x43,0x5D,0x8B,0x82,0x48,0x99,0x5D,0x62,0x57,0xA0,0xE3,0x80,0x2E,0x86,0x77,0xAF,0x4B,0xB7,0xB2,0x54,0x77,0xB2,0x84,0xF2,0x29,0x1D,0xDD,0x3C,0x16,0x7B,0x3D,0x13,0x08,0x79,0x37,0x7E,0x45,0xE6,0xC9,0x80,0x43,0x0F,0xD5,0x23,0x6C,0x64,0x88,0x5A,0x0A,0xD9,0x29,0x41,0x65,0xE3,0x8F,0x4D,0x3D,0xA9,0x57,0x47,0x48,0x89,0x28,0x53,0x3A,0x10,0x2A,0xBF,0x3B,0x78,0x8E,0x69,0x50,0x96,0x8B,0x27,0x4F,0x15,0xDD,0x05,0x0B,0xD1,0x80,0x6F,0x5B,0xCD,0xA3,0x4B,0x66,0x68,0x9A,0x45,0x12,0x84,0x5E,0x81,0x51,0x36,0x23,0xBC,0x75,0x11,0x5D,0xCD,0x61,0x61,0x92,0x89,0x22,0x36,0x9C,0x5A,0x48,0xC7,0x22,0x4B,0x62,0xB9,0x58,0x1D,0x39,0x9A,0x56,0x65,0x10,0xE4,0x06,0xE6,0x13,0x0D,0x87,0x18,0x1A,0x05,0xEF,0x50,0x58,0xA1,0xD3,0x10,0x6D,0xB6,0x67,0xE9,0x7C,0xE1,0x46,0x00,0x4C,0xC9,0x54,0x4D,0x17,0x40,0xB2,0x95,0x38,0x3E,0x2D,0x4C,0x41,0x6F,0x2B,0x07,0x56,0x75,0xD3,0x8D,0x08,0x28,0xCB,0x5A,0x27,0xA1,0xF2,0x46,0x6D,0x5D,0x42,0x04,0x76,0x82,0x83,0x9C,0x50,0x7A,0xE3,0xB3,0x20,0x22,0x7A,0xD0,0x3F,0x33,0x44,0x1A,0x26,0x06,0x28,0xF5,0x25,0x91,0x1F,0x9C,0x64,0xE4,0xE5,0x4A,0x7D,0x15,0x88,0x2A,0x2D,0x6F,0xCD,0xE9,0x10,0x56,0xA1,0x64,0x77,0x63,0x4E,0x5B,0x49,0x5E,0x7B,0xB5,0x20,0xC7,0x0D,0x99,0x4C,0x4A,0xE1,0x4D,0x33,0x99,0x9C,0x1F,0x75,0x43,0x4F,0xCE,0x29,0xB9,0xCF,0x6F,0x1C,0x98,0x16,0xA7,0x7E,0x1E,0xCE,0x15,0x1D,0xF9,0xBD,0x7B,0x1A,0x25,0xC4,0x48,0x08,0xEC,0x99,0xFB,0x0D,0xB3,0x4E,0x7D,0x61,0x27,0x59,0x7F,0x2F,0x48,0x31,0x80,0x32,0xEB,0x12,0xFE,0x58,0x63,0x58,0x25,0x1C,0xA6,0x90,0x74,0x70,0xB2,0xC8,0x1D,0x44,0x6B,0x20,0x4C,0x10,0x08,0xFE,0xF8,0x0B,0xB9,0xD8,0x7B,0x63,0x34,0x05,0x30,0x7D,0x43,0x41,0x2C,0x02,0x16,0x99,0x08,0x17,0x28,0x1C,0x22,0x17,0xA4,0xB4,0x18,0x12,0x58,0x8B,0x82,0x6F,0x7A,0xC1,0xED,0x0A,0x4E,0xBA,0x2F,0x39,0x2D,0xA0,0x89,0x74,0x80,0x56,0x4A,0x50,0x8F,0xA1,0x63,0x7A,0x35,0xC6,0xEC,0x5D,0xDB,0x1C,0x60,0x2F,0x69,0xE2,0xBF,0x46,0xBA,0x4F,0x86,0x3B,0x03,0x10,0xB2,0x30,0xA2,0x74,0xCA,0x38,0x05,0xEF,0xD0,0x15,0x91,0x8A,0x3D,0x75,0xE8,0xB4,0xA9,0x13,0x55,0x53,0x8A,0x61,0x53,0x43,0xED,0x7F,0xD0,0x94,0x78,0x6C,0x3B,0xA6,0xBF,0x2F,0x82,0x14,0x1D,0x6F,0x5A,0xBC,0x8B,0x1B,0x97,0xE3,0x6C,0x09,0xD2,0x87,0xDB,0x24,0xFE,0xB1,0x59,0x3C,0x2A,0x0E,0x7E,0x41,0x05,0x56,0x3C,0x41,0xD4,0xC1,0xAD,0x34,0xA5,0x7A,0xF1,0x34,0xF9,0x19,0xF9,0x19,0x34,0x8A,0x5F,0x08,0x03,0xEA,0xEE,0x5B,0x9E,0x23,0xF8,0x67,0x1A,0x51,0x21,0x0C,0x13,0x19,0x44,0x46,0x25,0x27,0xE2,0x73,0x2B,0xA0,0x3B,0x25,0xB0,0x78,0xF7,0x0A,0xE7,0xA6,0x9A,0x2B,0xFC,0x6C,0x93,0x26,0xD2,0xD5,0xDD,0x5F,0xC7,0x0F,0xFA,0x62,0xA7,0x7D,0x46,0x34,0x27,0x1D,0xDD,0x5C,0x67,0xCC,0x6A,0x2D,0x4D,0x3B,0x25,0x4A,0x65,0x08,0x3E,0x51,0x0B,0x63,0xAF,0x5C,0x3C,0x4B,0x6B,0x00,0x0B,0x72,0xC9,0x72,0x20,0x2B,0xC7,0x5C,0x40,0xC5,0x06,0x25,0x29,0x7C,0x90,0x7A,0x1F,0x5E,0xB5,0x7B,0x60,0x05,0x39,0x06,0xD0,0xD9,0xD2,0x79,0x97,0x9F,0x80,0x16,0xD5,0xC5,0x47,0x13,0x72,0x2B,0xA2,0x34,0xD9,0xB9,0x96,0x29,0xEB,0xFF,0x5F,0x10,0xE7,0xE1,0xC0,0x38,0x3D,0xA2,0x55,0x2B,0x9C,0x07,0xDC,0x63,0x45,0x55,0x19,0x6A,0xBA,0x6E,0x39,0x27,0x8D,0x44,0xB7,0x76,0xF8,0xDA,0xEB,0x7A,0xB3,0xC0,0x55,0x69,0x88,0xC9,0x27,0x44,0x3F,0x92,0x70,0x21,0x07,0xD3,0xEC,0x6D,0xCA,0x14,0x87,0x30,0xF0,0x21,0xB5,0x40,0xAC,0x77,0x88,0x29,0xA4,0xA7,0xDC,0x38,0x84,0x3E,0x95,0x5F,0xBF,0x39,0x01,0x4B,0x3C,0xFF,0x9D,0x4B,0x9D,0xAC,0xD2,0x43,0x9E,0xE8,0xB7,0x50,0x36,0xF7,0x83,0x19,0xD1,0xB4,0xB3,0x63,0x70,0x27,0x26,0x42,0xB3,0xD0,0x53,0x18,0x42,0x62,0xF5,0x2C,0xD5,0xD2,0x57,0x65,0xF4,0xA3,0xED,0x18,0x14,0x56,0x4B,0x76,0x73,0xDC,0x84,0x49,0x11,0xF7,0x46,0x1D,0x46,0xB2,0x14,0x2A,0x63,0x5A,0xBB,0x42,0x9E,0x21,0x4E,0x2F,0x47,0xAD,0x16,0x1C,0xDA,0x3B,0xCD,0x7F,0x2B,0x80,0x58,0x2C,0x4A,0xDC,0x4B,0x76,0x39,0xBD,0xA7,0x56,0x0F,0x7C,0xD2,0x2C,0x43,0x82,0xEA,0x39,0xAB,0xC3,0xFE,0x38,0xB3,0xB2,0x51,0x2A,0xC7,0xC9,0x56,0x33,0x07,0x1B,0xFB,0x47,0x39,0x9B,0x6A,0x06,0x1A,0xEE,0xC5,0x7B,0x8A,0x2C,0x4B,0x4B,0xDF,0x27,0xC3,0x7B,0x9E,0x48,0x15,0x5E,0x09,0x92,0xDE,0x68,0x96,0x47,0xA7,0x4F,0x74,0xCA,0x9A,0x12,0xCB,0xB9,0x64,0x1B,0x8E,0xB1,0x51,0x03,0xBA,0x9B,0xC6,0x1B,0xF2,0xFE,0x56,0x5A,0x62,0x42,0xFF,0x0B,0x7C,0x92,0x04,0x3F,0x37,0xCE,0x1C,0x27,0xDA,0x97,0xCF,0x15,0xB5,0xA4,0x85,0x19,0xE5,0x54,0x2F,0x67,0xB7,0x99,0x25,0x44,0x0F,0xED,0xF3,0x6F,0x4B,0x74,0xFC,0x37,0x65,0x55,0xBD,0x73,0x41,0xC5,0x76,0x69,0x94,0x2E,0x54,0x3E,0x67,0xD5,0xC4,0x5C,0xBE,0xB9,0xA6,0x69,0x43,0xE7,0xFB,0x49,0x9B,0x23,0xF0,0x24,0x44,0xFC,0x13,0x22,0x2D,0xAD,0xDE,0x6A,0xC9,0x9C,0xF6,0x30,0xE2,0x5A,0x6E,0x16,0xEF,0xFA,0x9A,0x2F,0xC8,0xF8,0xF5,0x4B,0x99,0x32,0x33,0x19,0x43,0x79,0xE0,0x2B,0xCE,0x7E,0xBE,0x79,0x67,0x30,0xA7,0x77,0xA6,0xE9,0xCD,0x54,0xEA,0xF2,0xF7,0x2B,0x86,0xAD,0x10,0x74,0xF3,0x95,0xBD,0x64,0x7A,0x87,0x5D,0x27,0x4D,0xDC,0x08,0x4A,0x78,0x09,0x58,0x27,0x99,0x98,0xED,0x77,0xC4,0x90,0x43,0x0A,0x53,0x21,0xF6,0x64,0x9F,0x88,0x81,0x06,0xA7,0x70,0x4A,0x32,0x67,0xCA,0x0A,0x2C,0x35,0xF2,0x05,0x2E,0x59,0xF3,0x9D,0x6A,0xF8,0x3A,0x8F,0x68,0x86,0x8E,0xDA,0x09,0xEC,0x53,0x99,0x4F,0x72,0x92,0x92,0x0A,0x22,0x69,0xD0,0x13,0x70,0xB7,0x5C,0x3F,0x7C,0x47,0xC0,0x0D,0xED,0x4B,0x90,0x55,0xE6,0x96,0x2E,0x51,0xBF,0x0A,0x29,0x41,0xE3,0xAF,0xCE,0x76,0x5C,0xE2,0xC4,0x02,0xFC,0xBB,0xB7,0x37,0x36,0x9F,0x15,0x4B,0x41,0xEE,0xFA,0x73,0x9B,0xE5,0x41,0x7E,0x84,0x73,0x67,0x7B,0x95,0x53,0xD3,0x1E,0x74,0xD4,0xF5,0x7A,0x10,0x5C,0xB1,0x50,0x60,0xF7,0xE9,0x34,0xD9,0x37,0x05,0x1F,0x8D,0x73,0x63,0x6B,0x3A,0x3D,0x06,0x48,0xED,0xE2,0x58,0x41,0xFD,0xBE,0x05,0x58,0x22,0xB8,0xC0,0x62,0x9B,0x34,0xC1,0x3A,0xEE,0x1A,0x9F,0x4C,0xAA,0x93,0x81,0x64,0x58,0x8E,0x37,0x22,0x38,0x3E,0x3A,0x4E,0xDC,0xBF,0xB9,0x4B,0xF8,0x53,0xAD,0x46,0x0F,0x84,0xBE,0x1A,0x58,0x93,0xEE,0x79,0x5D,0x16,0x98,0x3C,0x75,0xDF,0xC4,0x34,0x97,0x2B,0xFC,0x15,0xFF,0x72,0x58,0x47,0xB5,0xB7,0x5D,0x64,0xFB,0x03,0xE2,0x62,0xDD,0x36,0xAF,0x40,0x7F,0x26,0xF7,0x07,0x9C,0x8F,0x22,0x7C,0x8B,0xF5,0x37,0x63,0xAB,0x8D,0x3A,0x3F,0x52,0x5F,0xEE,0x79,0xF7,0x48,0x00,0x48,0xD8,0xD1,0xEF,0x44,0x20,0x55,0xA1,0x15,0x2D,0xC5,0x98,0x6D,0x89,0x69,0x3D,0x72,0xAB,0x9D,0xF2,0x04,0xFF,0x8C,0x3C,0x22,0xB6,0xF2,0x9F,0x4C,0xBE,0x40,0x0C,0x77,0x97,0x85,0xC4,0x65,0xEA,0xB4,0xC0,0x34,0x64,0x3D,0x80,0x57,0x3A,0xB4,0xD2,0x0F,0x34,0x7F,0xB7,0x48,0x3A,0x3B,0x1A,0x05,0xF3,0x85,0x2A,0x48,0xFE,0x31,0xDB,0x46,0x3D,0x17,0xD4,0x18,0x44,0x97,0x60,0x66,0xCD,0xA5,0xD1,0x4E,0xF8,0x94,0x29,0x0C,0x02,0xA9,0x8E,0x23,0x63,0xA8,0x43,0x56,0xC9,0xEE,0xF8,0x29,0x68,0x20,0x5C,0x3A,0x59,0x1E,0x5A,0x67,0xB5,0xFC,0x86,0x0D,0x7E,0x03,0x78,0x77,0x6D,0x88,0x9E,0x15,0x74,0xB3,0x95,0x6B,0xF8,0x0B,0xAA,0x52,0x83,0xB7,0x82,0x26,0x4E,0xCB,0x05,0x48,0xA1,0xFC,0x4C,0x40,0x03,0x69,0x45,0x43,0x13,0x19,0x6D,0x71,0x29,0xD8,0xDF,0x03,0x9E,0x27,0xAC,0x64,0x9E,0x63,0x7B,0x5A,0x2B,0x1D,0x5A,0x79,0x23,0xEF,0xF5,0x27,0x16,0x20,0xC6,0x24,0xAA,0x84,0xCA,0x55,0xD8,0x53,0x88,0x65,0x0E,0xC2,0xBE,0x4F,0x52,0xCD,0x8E,0x5A,0x29,0x4D,0xB9,0x59,0x1D,0x78,0x51,0x7C,0xB8,0x9B,0x98,0x4F,0xD1,0x73,0xAE,0x70,0x98,0x3E,0x4B,0x65,0x25,0x0E,0x42,0x48,0x17,0x0F,0xD4,0x35,0xCE,0x61,0xD9,0x75,0x78,0xA4,0x4E,0x18,0xC8,0xEC,0xA6,0x78,0xDC,0xEF,0xBF,0x6C,0xBE,0xF7,0x8B,0x14,0x3B,0x6C,0xC6,0x2E,0x75,0x30,0xC6,0x56,0xD1,0x28,0xBB,0x73,0x53,0x1B,0xB6,0x25,0xD1,0xAC,0xC4,0x64,0x7D,0x2E,0x1B,0x1C,0x63,0x47,0x97,0x66,0x92,0xEB,0x1C,0x04,0x29,0x33,0x43,0x1E,0x1A,0x15,0xB2,0x4F,0x1F,0xBB,0xA2,0x1A,0xBD,0xD4,0x47,0x78,0x9C,0xC7,0x7C,0x15,0x22,0xE6,0xC3,0x1A,0xCB,0xC0,0x1B,0x73,0xDA,0xAB,0xD0,0x59,0xE5,0xB2,0x85,0x4A,0x7D,0xAD,0x37,0x2F,0xD9,0x5C,0xED,0x75,0xFE,0xB8,0xDB,0x44,0x3F,0x05,0x68,0x78,0x4C,0xC2,0x63,0x34,0xDA,0x81,0x4D,0x23,0xEA,0x00,0x68,0x06,0x40,0x1A,0x87,0x01,0x99,0x02,0xC2,0x4F,0xC9,0x78,0xBF,0x73,0x04,0xD8,0xD7,0x49,0x15,0xD9,0x1A,0x0A,0xCD,0xFC,0x0A,0x02,0xFD,0x8B,0x40,0x0B,0xE0,0x16,0x69,0x52,0xB0,0x57,0xD0,0x04,0x17,0x49,0xC5,0x76,0x9F,0x2C,0xBB,0x1B,0x77,0x3E,0x29,0x3E,0x23,0xE4,0x74,0x3A,0x2D,0x77,0x4A,0x18,0xC0,0x7E,0x2B,0x11,0xCE,0xB8,0x7B,0x24,0x89,0x77,0x11,0x0A,0x15,0x42,0x63,0x39,0x7F,0xC9,0xD2,0x7E,0x72,0xCE,0x38,0x0D,0xBA,0x1B,0x79,0x4A,0xFA,0x4E,0xAC,0x0E,0xCB,0x3F,0x4A,0x4D,0x8D,0x37,0x64,0x39,0x3A,0x99,0x0F,0x79,0x71,0x12,0xC6,0x0B,0xD0,0x19,0x0B,0x6B,0x45,0x2E,0xCC,0x4B,0x95,0x2E,0x8A,0x05,0x28,0xD4,0x11,0x04,0xDE,0xB2,0xF7,0x23,0xA4,0x1A,0xC0,0x6F,0x6E,0xDC,0x65,0x50,0x32,0x52,0x6A,0x66,0xF6,0xAD,0xE5,0x76,0x53,0xA1,0x83,0x1B,0xD1,0x0E,0x1D,0x1C,0x6D,0x38,0x0C,0x18,0x39,0x9F,0x71,0x25,0x77,0x62,0x4C,0x36,0x56,0x57,0x0C,0x22};
int * keyPtr = (int*)m_TeaKey;
//7C 1E EF 00 CB 49 D2 40 9D 2F E5 13 D3 DD 16 04 B6 7D F1 0A 3E 59 0B 1E 27 77 B6 2F 85 71 21 30 A0 9D DF 75 70 D7 47 08 B2 7D 2A 6E D2 F7 FB 00 1D 89 6B 47 9B EA 9A 23 3F 6E FE 2F 68 FE 11 45 62 33 2A 4F 77 8A 2D 5E F4 04 49 39 92 DB 15 3E 50 FC E4 4D AC CF 4A 13 48 47 5F 3F CB 77 0D 12 9C FC 68 6C 95 AC B8 3D FA A8 7A 64 2A 15 1D 3F 8B 75 31 7F 6E F5 C7 11 6A 4B 09 0F 13 B3 3F 4D E4 95 32 47 09 A9 9A 10 FE 8E E3 42 FE FE E4 34 54 7D A5 30 96 48 0F 47 45 F3 99 44 20 81 CB 52 4A 5D 20 1B 60 24 A2 23 89 41 EB 5B DA C1 D9 70 26 58 84 3C 8B 46 52 71 1F D6 F2 52 40 CA 8D 7D E1 97 A7 01 36 9D B4 24 30 A7 45 76 D1 17 59 37 64 25 B2 65 38 55 1C 73 9B 6F EF 78 91 A7 C1 70 83 8F 1A 27 ED 29 2B 5C A4 7E 6F 12 ED 18 92 7E AE F3 EF 6F EB F0 38 38 16 A7 9D 09 38 22 1A 6C 2A B9 79 64 E7 10 29 04 E0 E9 47 09 F8 A8 0C 1F C1 DE C7 1C E7 32 9E 4B BC 52 3A 40 33 46 29 7F AB 96 CD 19 A0 FD 8F 0D 29 53 CA 24 48 8D F6 0D D3 9A 99 3E 1F 14 9E 0E 06 61 3E 6A 55 A3 A9 53 D5 47 5F 2C B0 D5 7E 22 CA BE 8C 31 78 36 82 49 D7 3B 3C 65 D1 D1 54 2E 6F A6 2C 49 4C 1A 55 0D 30 B9 4C 50 48 68 F1 7F 36 C0 6D 19 61 66 93 66 F6 BC 92 3C 5B A8 6D 41 4C 8F 76 64 5F E2 BA 10 AA 89 82 58 45 D7 CF 5B D0 5E DB 39 EB 76 26 30 26 CC 78 44 7F 33 77 47 07 5F B4 6C 13 F4 8B 6B C6 31 FC 60 87 8B 41 67 89 98 1C 21 08 5E BC 44 BF BD DF 6F 42 3D 8E 67 A4 7F 2E 6E 11 8A 03 78 6A 9B AD 0F E9 58 37 67 DF 7A 4F 4D A4 79 74 60 0F DD 4A 54 B1 F7 D5 61 97 07 B9 4F 1F 5D 18 49 AB 8D 2C 0F 66 AE C5 27 66 57 47 22 BA 96 E2 50 4C 1C EE 14 F3 95 54 71 F3 87 88 23 19 AE 69 06 60 F9 01 08 D2 A9 96 06 9A C6 71 1C D1 B2 64 1A 30 12 3C 7D 3C 2F E9 68 14 74 2F 65 E6 98 DB 19 95 94 A5 39 0E 03 9B 03 BC 9B BF 3C E5 32 A5 13 A5 8A FB 43 D9 66 D9 2C A9 E4 A9 01 45 09 D1 17 D1 1E 62 4D 0D 4F 3A 19 97 8B 3F 77 2B 4F CF 27 AF 48 EE 29 74 BE BF 17 D6 97 AA 15 ED 12 5E 4B BA D6 23 7A 6F C6 CD 43 8C 63 91 26 B8 4C 5B 6E B9 ED 78 27 38 1D A5 17 F5 68 F2 7A 61 FE B2 4C 8C 25 92 33 C0 95 4A 68 E4 9F 0D 63 32 9F 8D 66 76 C1 75 67 F0 CA 58 44 C4 61 0D 46 BB 22 BD 5C B2 57 24 4E DE 2B BD 1D BB B9 12 59 0A 4E 6D 2F 53 61 8C 4F 68 56 65 4B D0 20 00 4D A9 D9 40 5B 9B 7A 3E 31 39 72 37 4B 4E CA 70 5A 12 AD 4A 03 F5 A9 E1 10 75 2A F1 0D 80 2B 7C 52 9C 4C AA 1F AD C0 2E 79 D9 03 F0 50 50 36 0B 2C E5 FD 96 68 5E 8A 74 25 BE CF 85 0E 68 4C 28 72 B8 D9 09 1C CE 14 A0 18 28 46 4D 6B 96 5F 9B 35 27 0D 32 1E 81 F3 6A 39 79 11 D0 1C A3 2D AC 36 A4 97 F4 4E 87 31 01 7D FC 7B 91 74 F9 F6 E1 22 88 41 23 7D 66 61 0F 37 9A F0 51 34 07 69 D3 40 E4 40 69 1B 67 C2 BF 28 3E F4 A7 27 CA 4B 33 34 49 A0 D5 69 74 CE 44 6B EA CF 7F 46 A3 D4 6A 4E D6 02 E8 5F 31 02 F2 03 BD 98 41 04 70 8F 39 1A BC F1 05 10 D7 08 3D 5A 0F 8B BF 25 E6 18 30 32 89 4D 6F 06 21 39 E0 19 38 4F 03 35 1A 51 26 7A 6A A5 82 7A 8A CA 36 67 4F 3C A0 6C 24 DD F2 4C 97 9B 31 5B 77 53 DA 2D 52 59 68 1D CC 38 69 79 A9 AA 17 54 8D 19 57 14 B7 F8 BC 5F 34 A2 70 68 85 77 63 7B 5F 03 99 3F 0D 88 CC 7C 37 D9 97 00 F0 35 CC 39 17 65 2E 69 9B A1 8A 27 26 C0 39 1E 4B 33 D8 24 90 DB 47 05 1A 62 3F 60 05 DE AC 30 BA 4E D0 3D 91 74 40 32 A6 6D AF 0A B5 79 DA 08 BA EB C4 03 40 02 7E 2C EC B3 BE 7B 65 27 A6 41 2C 50 73 66 BC 85 EB 55 AB C1 0F 76 4D 4D FA 0E BA 8B 2D 60 61 46 35 7E A1 4A 32 41 2D 64 AF 0E A0 EF 0B 23 92 3D FA 0D DF E3 3C 38 EE 4D 41 79 8D 4B 91 29 77 3D DD 5E D7 46 23 5D C4 CF AA 2E 13 3E 88 7A 3E 40 77 60 DB 5F 8C 0E 1D 81 CB 23 85 9A 98 07 A0 AA 8A 02 57 A2 6F 5B 91 A6 76 11 E2 14 CE 28 2B 6B E3 75 81 B9 5F 17 25 75 82 74 71 7C A5 07 3F 36 C0 74 20 9B 08 51 D6 9B D5 69 C2 08 59 2F 13 D9 2D 61 E0 B6 5D 3A 22 3A F0 72 42 EE C7 65 44 F0 6D 4B 93 6E 5F 1F E7 E6 0B 7B 45 E3 33 2A B9 75 FE 54 1A 10 CD 17 B1 B2 C4 4A 7C B6 6E 6A 8B 96 2D 60 F1 56 F5 57 E0 03 3F 22 FA 8F 87 51 F9 8E 77 69 59 3E 88 51 ED 84 71 0A E4 62 6E 31 80 93 EE 66 0B 6F 7E 23 92 CD F9 04 BF 9E A8 2D AA 9F 08 47 2F 84 FA 11 31 4C 14 17 39 0D 02 35 D1 C8 E2 07 63 AE 3A 13 2F 21 0B 15 8E 50 14 52 9C 24 BC 32 92 BF D8 1F 33 13 2D 59 1F 33 C6 1E 20 3E 63 4A AE D4 D2 5A 3A 25 10 1C AD FB D7 01 63 4E 4A 6D CA EF 51 45 D6 EF F5 7F 26 35 14 14 BF 5C 84 3A 94 42 23 64 98 BC FB 25 C3 44 32 16 7F A4 91 0C 72 BF B3 10 53 0A D9 3C 66 05 28 15 5E 62 C1 57 1F 34 26 42 AE 90 5E 18 2E 0C B1 43 1B F8 70 48 76 BF F4 67 81 54 AD 27 63 A1 5E 56 C5 9F F2 1B 51 62 F3 46 F5 EB DC 28 E6 E2 1B 2E 5A 74 DF 2E A8 04 E2 27 E3 3B 02 70 6F AE E9 57 B8 81 31 6F E4 95 91 43 55 8D ED 60 03 4E 60 2A 52 51 24 5F 92 E2 C3 7C F9 CE 9B 50 83 07 76 37 02 4D A2 1E 4A F1 4C 3D F7 5B 0A 0C 10 D3 9B 0B 5E BC 31 0C 9A 4D 3C 03 00 1E C7 57 D6 2F 93 43 54 12 90 28 D9 CA BB 72 20 4E CA 6F 74 89 3D 07 9F 90 FF 1F 0A F0 F0 45 18 B5 03 7F 0B 4C 28 69 EF 58 23 38 C5 24 DC 16 81 B4 4E 6A C5 83 4D 2E 5D 42 42 01 7C 55 6F 41 0A 4A 01 2D 2E 65 0E 72 C6 06 2F 32 13 F2 99 33 45 2C 0A 74 56 D4 DF 0B AD BD C6 54 94 66 91 6F AB CE 5D 65 D4 F9 EE 09 FC 05 E4 7C 57 0E E7 32 AA 65 06 11 79 32 77 50 67 C3 15 62 02 DF 65 0B 40 96 D6 6E 1C B3 06 47 05 7E 69 7C 8A 9E 74 7F 2A 81 CD 03 2A C6 BA 63 4A 94 39 6B 6F 1A 33 4C 8E 90 86 12 2D E9 E5 2B C4 4F CC 74 52 89 B0 61 69 DD 4D 13 58 69 A0 29 B9 5E E2 60 E9 49 E8 7F 27 9E 1B 01 57 1A 4B 24 B4 C8 DB 66 D8 B8 EC 0F FF DF C4 40 2B 41 5E 6D 75 88 C1 0D 0F 05 C4 53 98 BB E8 17 6B B1 3A 1F 7D 24 83 71 77 D4 C4 4A FE CE 98 4E 32 87 B6 05 CE E2 17 77 F2 25 EE 61 FB 40 F5 66 75 9A 2A 23 B7 59 89 60 D7 FD B7 30 8E 46 65 6C 4F 0F 8A 11 43 94 D1 44 CA CE 67 73 78 01 1D 4D F3 02 60 15 F0 DE 35 35 9B 32 3E 2E E2 5F 28 3A 8B 36 D8 74 28 30 48 1B A2 F5 66 5C AC 68 5C 56 1F 30 5C 54 D0 2C F7 75 F0 18 A8 7B A4 0D DC 16 87 46 C8 54 AE 96 1A 49 FE 56 F7 0C 4B D7 AE 5D 6B CD 00 2B 31 EC 46 7A A7 0F 7F 17 DA 4D 2D 07 54 BD D5 11 12 28 5F 63 23 DA A5 34 A9 57 56 6E 10 CE F6 43 7E C0 21 5B AC AA 25 1C 64 74 C8 5A E9 BA A2 6D 46 D3 81 71 2F 27 34 77 24 6B FE 72 3A 2A 6C 28 1B D6 1F 02 73 AE FB 2B 12 6F E0 0C F9 36 AE 50 E5 26 25 2A A5 0D 07 63 E8 41 FD 49 58 4E 0A 16 E3 51 5D 10 A5 D6 81 17 D1 C9 04 30 47 9A 15 79 6E C6 E7 42 72 B2 23 25 25 E5 D5 37 7F 15 12 2C CA 02 58 4D D3 68 92 12 D9 6B 2C 0C 39 1C 53 21 36 CE 11 34 82 D4 25 48 DE FB 89 15 2D 8B D6 62 1B 54 75 3B A2 40 A3 30 D9 31 0E 37 C9 1E 00 05 1F 75 38 24 A8 14 A7 56 BE 34 F9 27 71 4B 6F 6A DF 76 DF 5C 43 B2 8C 31 22 07 4D 40 F6 D5 E4 4A 2A C7 14 4F 0A 03 BB 2D 72 2B 3D 57 23 79 16 39 85 99 26 39 8D EE B1 0D B4 09 E0 77 7C 99 4F 2A D0 88 EF 54 83 06 C3 2A BF 0B E1 58 84 57 30 45 63 76 7F 72 AE 6F 45 4A 5C C3 6F 40 08 DB 86 40 4E 6E 49 27 E5 FA 4B 44 57 A2 AA 2E 7D 2E 93 4A C3 0C 68 6F B6 87 62 41 8A DB 54 79 94 0B BE 6F B0 24 DF 21 7C AD 27 78 78 DB FE 7C 4F 6A 93 21 98 A1 86 71 99 8A 0C 41 25 6B C9 3A 6F CE 7E 16 29 6F BD 45 75 B3 04 24 D7 29 8E 4B B0 1A 68 25 29 F1 AB 16 70 9C D8 1E 2D 36 DB 27 D2 59 F5 74 86 C0 2E 0D 48 3A 9F 7D BC 13 2C 02 63 F1 8B 4D DC 0E 2B 3D 5F 98 A3 4E 4D 35 A9 79 9C 1F 52 5F C4 19 1B 66 46 B6 70 15 2F 79 DD 43 90 C0 85 58 F9 B2 4F 17 D9 B1 C4 6D 6F 38 EA 02 D0 41 D0 77 9D D8 94 4F 3B 27 1D 0A 6E 5C B4 52 3C 78 22 30 87 10 18 2D 00 4D 89 21 00 8E AC 25 79 4F 0C 75 AF 85 AB 3E 2C 60 CC 0E 31 FE 0F 0E 0A 86 1A 78 E3 6B 83 0A DC 00 0B 07 58 9F F4 69 DB 7A 36 38 6D 8A 62 28 0E 56 B0 05 41 E4 93 1A 47 07 F3 68 E8 70 C9 1C 68 AA 2D 46 47 F8 FA 65 CF 9F DB 48 BB D9 35 22 E8 0F E8 2E 6D F7 91 16 CD 43 32 20 D5 04 E8 4C D2 84 13 6E 57 5E E3 36 1E C0 48 31 E8 73 E3 5C F6 14 6D 7D F9 D5 B2 50 CF 1A 48 29 B1 99 FF 6C CB 81 F0 2A 6B F8 7F 7E 30 6C A2 08 6A E2 65 3B 1C 46 AC 44 29 19 53 43 5D 8B 82 48 99 5D 62 57 A0 E3 80 2E 86 77 AF 4B B7 B2 54 77 B2 84 F2 29 1D DD 3C 16 7B 3D 13 08 79 37 7E 45 E6 C9 80 43 0F D5 23 6C 64 88 5A 0A D9 29 41 65 E3 8F 4D 3D A9 57 47 48 89 28 53 3A 10 2A BF 3B 78 8E 69 50 96 8B 27 4F 15 DD 05 0B D1 80 6F 5B CD A3 4B 66 68 9A 45 12 84 5E 81 51 36 23 BC 75 11 5D CD 61 61 92 89 22 36 9C 5A 48 C7 22 4B 62 B9 58 1D 39 9A 56 65 10 E4 06 E6 13 0D 87 18 1A 05 EF 50 58 A1 D3 10 6D B6 67 E9 7C E1 46 00 4C C9 54 4D 17 40 B2 95 38 3E 2D 4C 41 6F 2B 07 56 75 D3 8D 08 28 CB 5A 27 A1 F2 46 6D 5D 42 04 76 82 83 9C 50 7A E3 B3 20 22 7A D0 3F 33 44 1A 26 06 28 F5 25 91 1F 9C 64 E4 E5 4A 7D 15 88 2A 2D 6F CD E9 10 56 A1 64 77 63 4E 5B 49 5E 7B B5 20 C7 0D 99 4C 4A E1 4D 33 99 9C 1F 75 43 4F CE 29 B9 CF 6F 1C 98 16 A7 7E 1E CE 15 1D F9 BD 7B 1A 25 C4 48 08 EC 99 FB 0D B3 4E 7D 61 27 59 7F 2F 48 31 80 32 EB 12 FE 58 63 58 25 1C A6 90 74 70 B2 C8 1D 44 6B 20 4C 10 08 FE F8 0B B9 D8 7B 63 34 05 30 7D 43 41 2C 02 16 99 08 17 28 1C 22 17 A4 B4 18 12 58 8B 82 6F 7A C1 ED 0A 4E BA 2F 39 2D A0 89 74 80 56 4A 50 8F A1 63 7A 35 C6 EC 5D DB 1C 60 2F 69 E2 BF 46 BA 4F 86 3B 03 10 B2 30 A2 74 CA 38 05 EF D0 15 91 8A 3D 75 E8 B4 A9 13 55 53 8A 61 53 43 ED 7F D0 94 78 6C 3B A6 BF 2F 82 14 1D 6F 5A BC 8B 1B 97 E3 6C 09 D2 87 DB 24 FE B1 59 3C 2A 0E 7E 41 05 56 3C 41 D4 C1 AD 34 A5 7A F1 34 F9 19 F9 19 34 8A 5F 08 03 EA EE 5B 9E 23 F8 67 1A 51 21 0C 13 19 44 46 25 27 E2 73 2B A0 3B 25 B0 78 F7 0A E7 A6 9A 2B FC 6C 93 26 D2 D5 DD 5F C7 0F FA 62 A7 7D 46 34 27 1D DD 5C 67 CC 6A 2D 4D 3B 25 4A 65 08 3E 51 0B 63 AF 5C 3C 4B 6B 00 0B 72 C9 72 20 2B C7 5C 40 C5 06 25 29 7C 90 7A 1F 5E B5 7B 60 05 39 06 D0 D9 D2 79 97 9F 80 16 D5 C5 47 13 72 2B A2 34 D9 B9 96 29 EB FF 5F 10 E7 E1 C0 38 3D A2 55 2B 9C 07 DC 63 45 55 19 6A BA 6E 39 27 8D 44 B7 76 F8 DA EB 7A B3 C0 55 69 88 C9 27 44 3F 92 70 21 07 D3 EC 6D CA 14 87 30 F0 21 B5 40 AC 77 88 29 A4 A7 DC 38 84 3E 95 5F BF 39 01 4B 3C FF 9D 4B 9D AC D2 43 9E E8 B7 50 36 F7 83 19 D1 B4 B3 63 70 27 26 42 B3 D0 53 18 42 62 F5 2C D5 D2 57 65 F4 A3 ED 18 14 56 4B 76 73 DC 84 49 11 F7 46 1D 46 B2 14 2A 63 5A BB 42 9E 21 4E 2F 47 AD 16 1C DA 3B CD 7F 2B 80 58 2C 4A DC 4B 76 39 BD A7 56 0F 7C D2 2C 43 82 EA 39 AB C3 FE 38 B3 B2 51 2A C7 C9 56 33 07 1B FB 47 39 9B 6A 06 1A EE C5 7B 8A 2C 4B 4B DF 27 C3 7B 9E 48 15 5E 09 92 DE 68 96 47 A7 4F 74 CA 9A 12 CB B9 64 1B 8E B1 51 03 BA 9B C6 1B F2 FE 56 5A 62 42 FF 0B 7C 92 04 3F 37 CE 1C 27 DA 97 CF 15 B5 A4 85 19 E5 54 2F 67 B7 99 25 44 0F ED F3 6F 4B 74 FC 37 65 55 BD 73 41 C5 76 69 94 2E 54 3E 67 D5 C4 5C BE B9 A6 69 43 E7 FB 49 9B 23 F0 24 44 FC 13 22 2D AD DE 6A C9 9C F6 30 E2 5A 6E 16 EF FA 9A 2F C8 F8 F5 4B 99 32 33 19 43 79 E0 2B CE 7E BE 79 67 30 A7 77 A6 E9 CD 54 EA F2 F7 2B 86 AD 10 74 F3 95 BD 64 7A 87 5D 27 4D DC 08 4A 78 09 58 27 99 98 ED 77 C4 90 43 0A 53 21 F6 64 9F 88 81 06 A7 70 4A 32 67 CA 0A 2C 35 F2 05 2E 59 F3 9D 6A F8 3A 8F 68 86 8E DA 09 EC 53 99 4F 72 92 92 0A 22 69 D0 13 70 B7 5C 3F 7C 47 C0 0D ED 4B 90 55 E6 96 2E 51 BF 0A 29 41 E3 AF CE 76 5C E2 C4 02 FC BB B7 37 36 9F 15 4B 41 EE FA 73 9B E5 41 7E 84 73 67 7B 95 53 D3 1E 74 D4 F5 7A 10 5C B1 50 60 F7 E9 34 D9 37 05 1F 8D 73 63 6B 3A 3D 06 48 ED E2 58 41 FD BE 05 58 22 B8 C0 62 9B 34 C1 3A EE 1A 9F 4C AA 93 81 64 58 8E 37 22 38 3E 3A 4E DC BF B9 4B F8 53 AD 46 0F 84 BE 1A 58 93 EE 79 5D 16 98 3C 75 DF C4 34 97 2B FC 15 FF 72 58 47 B5 B7 5D 64 FB 03 E2 62 DD 36 AF 40 7F 26 F7 07 9C 8F 22 7C 8B F5 37 63 AB 8D 3A 3F 52 5F EE 79 F7 48 00 48 D8 D1 EF 44 20 55 A1 15 2D C5 98 6D 89 69 3D 72 AB 9D F2 04 FF 8C 3C 22 B6 F2 9F 4C BE 40 0C 77 97 85 C4 65 EA B4 C0 34 64 3D 80 57 3A B4 D2 0F 34 7F B7 48 3A 3B 1A 05 F3 85 2A 48 FE 31 DB 46 3D 17 D4 18 44 97 60 66 CD A5 D1 4E F8 94 29 0C 02 A9 8E 23 63 A8 43 56 C9 EE F8 29 68 20 5C 3A 59 1E 5A 67 B5 FC 86 0D 7E 03 78 77 6D 88 9E 15 74 B3 95 6B F8 0B AA 52 83 B7 82 26 4E CB 05 48 A1 FC 4C 40 03 69 45 43 13 19 6D 71 29 D8 DF 03 9E 27 AC 64 9E 63 7B 5A 2B 1D 5A 79 23 EF F5 27 16 20 C6 24 AA 84 CA 55 D8 53 88 65 0E C2 BE 4F 52 CD 8E 5A 29 4D B9 59 1D 78 51 7C B8 9B 98 4F D1 73 AE 70 98 3E 4B 65 25 0E 42 48 17 0F D4 35 CE 61 D9 75 78 A4 4E 18 C8 EC A6 78 DC EF BF 6C BE F7 8B 14 3B 6C C6 2E 75 30 C6 56 D1 28 BB 73 53 1B B6 25 D1 AC C4 64 7D 2E 1B 1C 63 47 97 66 92 EB 1C 04 29 33 43 1E 1A 15 B2 4F 1F BB A2 1A BD D4 47 78 9C C7 7C 15 22 E6 C3 1A CB C0 1B 73 DA AB D0 59 E5 B2 85 4A 7D AD 37 2F D9 5C ED 75 FE B8 DB 44 3F 05 68 78 4C C2 63 34 DA 81 4D 23 EA 00 68 06 40 1A 87 01 99 02 C2 4F C9 78 BF 73 04 D8 D7 49 15 D9 1A 0A CD FC 0A 02 FD 8B 40 0B E0 16 69 52 B0 57 D0 04 17 49 C5 76 9F 2C BB 1B 77 3E 29 3E 23 E4 74 3A 2D 77 4A 18 C0 7E 2B 11 CE B8 7B 24 89 77 11 0A 15 42 63 39 7F C9 D2 7E 72 CE 38 0D BA 1B 79 4A FA 4E AC 0E CB 3F 4A 4D 8D 37 64 39 3A 99 0F 79 71 12 C6 0B D0 19 0B 6B 45 2E CC 4B 95 2E 8A 05 28 D4 11 04 DE B2 F7 23 A4 1A C0 6F 6E DC 65 50 32 52 6A 66 F6 AD E5 76 53 A1 83 1B D1 0E 1D 1C 6D 38 0C 18 39 9F 71 25 77 62 4C 36 56 57 0C 22


extern "C" void __declspec(dllexport) EncryptTCP(char* pBuf, const UINT uiSize)
{
	UINT uiEncodeSize = uiSize;

	int iBlockCount = uiSize / 8;
	if (uiSize%8)
		iBlockCount++;

	UINT y, z, uiSum, uiLimit, uiRound;

	uiRound = (uiSize % 2) + 1;

	for (int i = 0; i<iBlockCount; i++)
	{

		UINT* pKey = (UINT*)m_TeaKey[uiSize%256];

		uiSum = 0;
		uiLimit = uiRound * 0x9E3779B9;

		if (uiEncodeSize >= 8)
		{
			memcpy(&y, pBuf + (i*8), sizeof(UINT));
			memcpy(&z, pBuf + ((i*8) + 4), sizeof(UINT));

			// start cycle
			while (uiSum != uiLimit)
			{
				y += (z << 4 ^ z >> 5) + z ^ uiSum + pKey[uiSum & 3];
				uiSum += 0x9E3779B9;
				z += (y << 4 ^ y >> 5) + y ^ uiSum + pKey[uiSum >> 11 & 3];
			}
		
			memcpy(pBuf + (i*8), &y, sizeof(UINT));
			memcpy(pBuf + (i*8) + 4, &z, sizeof(UINT));

			uiEncodeSize -= 8;
		}
		else //edge case for < 8 size.
		{
			char* pTempBuf = pBuf + (i*8);

			for (UINT j = 0; j<uiEncodeSize; ++j)
			{
				pTempBuf[j] ^= (reinterpret_cast<char*>(pKey))[j];
			}
		}
	}
}

extern "C" void __declspec(dllexport) DecryptTCP(char* pBuf, const UINT uiSize)
{
	UINT uiDecryptSize = uiSize;

	int iBlockCount = uiSize / 8;
	if (uiSize%8)
		iBlockCount++;
	
	UINT y, z, uiSum, uiRound;

	uiRound = (uiSize % 2) + 1;

	for (int i = 0; i<iBlockCount; i++)
	{
		//UINT* pKey = s_TeaKey[rand.rand()%TEA_KEYCOUNT];
		UINT* pKey = (UINT*)m_TeaKey[uiSize%256];

		uiSum = uiRound * 0x9E3779B9;		
	
		if (uiDecryptSize >= 8)
		{
			memcpy(&y, pBuf + (i*8), sizeof(UINT));
			memcpy(&z, pBuf + ((i*8) + 4), sizeof(UINT));

			// start cycle
			while (uiSum)
			{
				z -= (y << 4 ^ y >> 5) + y ^ uiSum + pKey[uiSum >> 11 & 3];
				uiSum -= 0x9E3779B9;
				y -= (z << 4 ^ z >> 5) + z ^ uiSum + pKey[uiSum & 3];
			}
			// end cycle

			memcpy(pBuf + (i*8), &y, sizeof(UINT));
			memcpy(pBuf + (i*8) + 4, &z, sizeof(UINT));

			uiDecryptSize -= 8;
		}	
		else
		{
			char* pTempBuf = pBuf + (i*8);

			for (UINT j = 0; j<uiDecryptSize; ++j)
			{
				pTempBuf[j] ^= (reinterpret_cast<char*>(pKey))[j];
			}
		}
	}
}

